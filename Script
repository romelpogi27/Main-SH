local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local function SpawnSH()
	_G.Enabled = true
	
	for _, v in pairs(CoreGui:GetChildren()) do
		if v:IsA("ScreenGui") and v.Name == "ScriptH" then
			v:Destroy()
		end
	end
	
	--//Variables
	local enabled = true
	local TweenService = game:GetService("TweenService")
	local Lp = game.Players.LocalPlayer
	local PlayerGui = Lp.PlayerGui
	
	local Gui = Instance.new("ScreenGui", CoreGui)
	local Frame = Instance.new("Frame", Gui)
	local UiDrag = Instance.new("UIDragDetector", Frame)
	local GridLay = Instance.new("UIGridLayout", Frame)
	local TweenTool = Instance.new("TextButton", Frame)
	local BringPart = Instance.new("TextBox", Frame)
	local BringAllPart = Instance.new("TextBox", Frame)
	local TweenToPlr = Instance.new("TextBox", Frame)
	local FlyTool = Instance.new("TextButton", Frame)
	
	--//Properties
	Gui.Name = "Framework"
	Gui.Enabled = enabled
	Gui.Name = "ScriptH"
	
	Frame.Name = "Frame"
	Frame.Visible = true
	Frame.Active = true
	Frame.Size = UDim2.new(0, 800, 0, 500)
	Frame.Position = UDim2.new(0.171, 62, 0.208, -22)
	
	TweenTool.Name = "TweenTool"
	TweenTool.Text = "Tween Tool"
	TweenTool.Size = UDim2.new(0, 200,0, 50)
	TweenTool.TextScaled = true
	
	BringPart.Name = "BringPart"
	BringPart.Text = "Tween Bring Part!"
	BringPart.Size = UDim2.new(0, 200,0, 50)
	BringPart.TextScaled = true
	BringPart:SetAttribute("Desc", 'Tween Bring Part!')
	
	BringAllPart.Name = "BringAllPart"
	BringAllPart.Text = "Tween Bring All Part!"
	BringAllPart.Size = UDim2.new(0, 200,0, 50)
	BringAllPart:SetAttribute("Desc", 'Tween Bring All Part')
	BringAllPart.TextScaled = true
	
	TweenToPlr.Name = "BringAllPart"
	TweenToPlr.Text = "Tween To Player"
	TweenToPlr.Size = UDim2.new(0, 200,0, 50)
	TweenToPlr:SetAttribute("Desc", 'Tween To Player')
	TweenToPlr.TextScaled = true
	
	FlyTool.Name = "FlyTool"
	FlyTool.Text = "Fly Tool"
	FlyTool.Size = UDim2.new(0, 200, 0, 50)
	FlyTool:SetAttribute("Desc", "Fly Tool")
	FlyTool.TextScaled = true
	
	--//Main Script
	for _, v in pairs(Frame:GetChildren()) do
		if v:IsA("TextButton") then
			v.Activated:Connect(function()
				if v.Name == TweenTool.Name then
					local Tool = Instance.new("Tool", Lp.Backpack)
					Tool.Name = "TweenTool"
					Tool.RequiresHandle = false

					Tool.Activated:Connect(function()
						Lp.Character.HumanoidRootPart.Anchored = true
						local Mouse = Lp:GetMouse()
						local MousePos = Mouse.Hit.Position + Vector3.new(0, 2.5, 0)

						local Tween = TweenService:Create(Lp.Character.HumanoidRootPart, TweenInfo.new(3), {CFrame = CFrame.new(MousePos)})
						Tween:Play()
						Tween.Completed:Connect(function()
							Lp.Character.HumanoidRootPart.Anchored = false
						end)
					end)
				elseif v.Name == FlyTool.Name then
					local FlyTool = Instance.new("Tool", Lp.Backpack)
					FlyTool.Name = "FlyTool"
					FlyTool.RequiresHandle = false
					
					FlyTool.Equipped:Connect(function()
						local flyActive = true
						local Params = RaycastParams.new()
						Params.FilterType = Enum.RaycastFilterType.Blacklist
						
						local function blacklist()
							local blacklist = {}
							table.insert(blacklist, Lp.Character)
							Params.FilterDescendantsInstances = blacklist
						end
						
						local function update()
							if not flyActive then return end
							local connection
							
							local HumanoidRootPart = Lp.Character:FindFirstChild("Head")
							blacklist()
							if HumanoidRootPart then
								local CameraPos = workspace.CurrentCamera.CFrame.Position
								local CameraDir = workspace.CurrentCamera.CFrame.LookVector
								
								local rayPos = CameraPos
								local rayDir = CameraDir * 100
								
								local result = workspace:Raycast(rayPos, rayDir, Params)
								
								local targetPos
								if result then
									targetPos = result.Position
								end
								HumanoidRootPart.CFrame = CFrame.new(HumanoidRootPart.Position, targetPos)
							end
						end
						
						local heartbeatConnection = RunService.RenderStepped:Connect(update)
						
						FlyTool.Unequipped:Connect(function()
							flyActive = false
							heartbeatConnection:Disconnect()
						end)
					end)
				end
			end)
		end
	end

	BringPart.FocusLost:Connect(function(enterPressed)
		if enterPressed then
			local partName = BringPart.Text
			local part = game.Workspace:FindFirstChild(partName)

			if not part.PrimaryPart then
				local Tween = TweenService:Create(part, TweenInfo.new(3), {CFrame = Lp.Character.HumanoidRootPart.CFrame})
				Tween:Play()
			elseif part.PrimaryPart then
				local Tween = TweenService:Create(part.PrimaryPart, TweenInfo.new(3), {CFrame = Lp.Character.HumanoidRootPart.CFrame})
				Tween:Play()
			else
				print("no work")
			end

			BringPart.Text = BringPart:GetAttribute("Desc")
		end
	end)

	BringAllPart.FocusLost:Connect(function(enterPressed)
		if enterPressed then
			local PartN = BringAllPart.Text
			if PartN then
				for _, v in pairs(workspace:GetChildren()) do
					if v.Name == PartN and not v.PrimaryPart then
						local Tween = TweenService:Create(v, TweenInfo.new(3), {CFrame = Lp.Character.HumanoidRootPart.CFrame})
						Tween:Play()
					elseif v.Name == PartN and v.PrimaryPart then
						local Tween = TweenService:Create(v.PrimaryPart, TweenInfo.new(3), {CFrame = Lp.Character.HumanoidRootPart.CFrame})
						Tween:Play()
					end
				end
			end
			BringAllPart.Text = BringAllPart:GetAttribute("Desc")
		end
	end)

	TweenToPlr.FocusLost:Connect(function(enterPressed)
		if enterPressed then
			local partialName = TweenToPlr.Text
			if partialName and partialName ~= "" then
				local foundPlayer = nil

				for _, player in pairs(game.Players:GetPlayers()) do
					if string.find(player.Name:lower(), partialName:lower(), 1, true) then
						foundPlayer = player
						break
					end
				end

				if foundPlayer and foundPlayer.Character and foundPlayer.Character:FindFirstChild("HumanoidRootPart") then
					local targetPosition = foundPlayer.Character.HumanoidRootPart.CFrame
					local Tween = TweenService:Create(
						Lp.Character.HumanoidRootPart,
						TweenInfo.new(3),
						{ CFrame = targetPosition }
					)
					Tween:Play()
				else
					print("Player not found or doesn't have a valid character!")
				end
			end
			TweenToPlr.Text = TweenToPlr:GetAttribute("Desc")
		end
	end)
	
	local function toogle()
		enabled = not enabled
		Gui.Enabled = enabled
	end

	UserInputService.InputBegan:Connect(function(input)
		if input.KeyCode == Enum.KeyCode.LeftControl then
			toogle()
		end
	end)
end

local function ReloadSH()
	SpawnSH()
end

ReloadSH()
